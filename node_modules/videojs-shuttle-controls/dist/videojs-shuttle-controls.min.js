/*! @name videojs-shuttle-controls @version 1.1.1 @license MIT */
!function(e,a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],a):(e=e||self).videojsShuttleControls=a(e.videojs)}(this,function(e){"use strict";var a=(e=e&&e.hasOwnProperty("default")?e.default:e).getPlugin("plugin"),t={playPauseKeys:[" ","k"],backwardKeys:["j"],forwardKey:["l"],backwardFrameKey:["ArrowLeft"],forwardFrameKey:["ArrowRight"],shiftMagnification:10,fps:30,playbackRates:[-10,-5,-2,-1,-.5,.5,1,2,5,10]};function i(e){null!==e&&"function"==typeof e.then&&e.then(null,function(e){})}var r=function(a){var r,n;function s(i,r){var n;return(n=a.call(this,i)||this).options=e.mergeOptions(t,r),n.player.ready(function(){n.player.addClass("vjs-shuttle-controls")}),n.playPauseKeys=n.options.playPauseKeys,n.backwardKeys=n.options.backwardKeys,n.forwardKey=n.options.forwardKey,n.backwardFrameKey=n.options.backwardFrameKey,n.forwardFrameKey=n.options.forwardFrameKey,n.shiftMagnification=n.options.shiftMagnification,n.fps=n.options.fps,n.currentPlaybackRate=1,n.isPlaying=!1,n.player.on("play",function(){n.isPlaying=!0}),n.player.on("keydown",function(e){n._onKeydown(e)}),n.playbackRates=n.options.playbackRates,i.options_.playbackRates.length&&(n.playbackRates=i.options_.playbackRates),n}n=a,(r=s).prototype=Object.create(n.prototype),r.prototype.constructor=r,r.__proto__=n;var o=s.prototype;return o._onKeydown=function(e){this._clearNegativeTimer();var a=e.shiftKey?this.shiftMagnification:1;this.playPauseKeys.indexOf(e.key)>-1&&this._togglePlay(),this.forwardKey.indexOf(e.key)>-1&&this._shuttlePlaybackRate(1),this.backwardKeys.indexOf(e.key)>-1&&this._shuttlePlaybackRate(-1),this.forwardFrameKey.indexOf(e.key)>-1&&this.frameByFrame(a),this.backwardFrameKey.indexOf(e.key)>-1&&this.frameByFrame(-a)},o._togglePlay=function(){var e=this.player;this.isPlaying?(e.playbackRate(1),e.$(".vjs-playback-rate-value").innerHTML="1x",this._clearNegativeTimer(),this.isPlaying=!1,e.pause()):(this._play(1),i(e.play()))},o._negativePlay=function(e,a){var t=1/this.fps;this.isPlaying=!0,a.pause(),a.$(".vjs-playback-rate-value").innerHTML=e+"x";var i=this.player.currentTime()+t*e;i<0&&(i=a.duration()),a.currentTime(i)},o._play=function(e){var a=this;this.isPlaying=!0;var t=this.player;if(this.currentPlaybackRate=e,this._clearNegativeTimer(),e>0)t.playbackRate(e),i(t.play());else{var r=1/this.fps;this.negativeTimer=setInterval(function(){a._negativePlay(e,t)},1e3*r)}},o._clearNegativeTimer=function(){this.negativeTimer&&clearInterval(this.negativeTimer)},o._shuttlePlaybackRate=function(e){if(this.isPlaying){var a=this.playbackRates,t=this.currentPlaybackRate,i=a.indexOf(t),r=Math.min(Math.max(i+e,0),a.length-1);this._play(a[r])}else this._play(e)},o.frameByFrame=function(e){var a=this.player,t=1/this.fps;a.pause(),a.currentTime(this.player.currentTime()+t*e)},s}(a);return r.defaultState={},r.VERSION="1.1.1",e.registerPlugin("shuttleControls",r),r});
